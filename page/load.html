<style>
    .top-panel {
        border: 1px solid #eceff9;
        border-radius: 5px;
        text-align: center;
    }

    .top-panel > .layui-card-body {
        height: 60px;
    }

    .top-panel-number {
        line-height: 60px;
        font-size: 30px;
        border-right: 1px solid #eceff9;
    }

    .top-panel-tips {
        line-height: 30px;
        font-size: 12px
    }
</style>

<div class="layuimini-container layuimini-page-anim" id="3" value="1">

    <div class="layuimini-main welcome">
        <div class="layui-row layui-col-space15">
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">CPU使用</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div class="layui-col-xs9 layui-col-md9 top-panel-number" >
                                20%
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">内存使用</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div class="layui-col-xs9 layui-col-md9 top-panel-number" id="memory">
                                9,054,056
                            </div>
                            <div class="layui-col-xs3 layui-col-md3 top-panel-tips">
                                比昨天 <a style="color: #1aa094">▲0.12</a><br>
<!--                                比七日 <a style="color: #bd3004">▼0.06</a>-->
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">磁盘使用</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div class="layui-col-xs9 layui-col-md9 top-panel-number">
                                20%
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="layui-col-xs12 layui-col-md3">

                <div class="layui-card top-panel">
                    <div class="layui-card-header">流量使用</div>
                    <div class="layui-card-body">
                        <div class="layui-row layui-col-space5">
                            <div class="layui-col-xs9 layui-col-md9 top-panel-number">
                                20%
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>


        <div class="layui-row layui-col-space10">
            <div class="layui-col-xs12 layui-col-md5">
                <div id="echarts-records" style="background-color:#ffffff;min-height:400px;padding: 10px"></div>
            </div>
            <div class="layui-col-xs12 layui-col-md5">
                <div id="echarts-records1" style="background-color:#ffffff;min-height:400px;padding: 10px"></div>
            </div>
        </div>

        <div class="layui-row layui-col-space15">
            <div class="layui-col-xs12 layui-col-md6">
                <div id="echarts-dataset" style="background-color:#ffffff;min-height:300px;padding: 10px"></div>
            </div>
            <div class="layui-col-xs12 layui-col-md3">
                <div id="echarts-map" style="background-color:#ffffff;min-height:300px;padding: 10px"></div>
            </div>
        </div>
    </div>
</div>
<script>
    let i = 1
    layui.use(['layer', 'echarts', 'form'], function () {
        var $ = layui.jquery,
            layer = layui.layer,
            echarts = layui.echarts;


        /**
         * 报表功能
         */
        var echartsRecords = echarts.init(document.getElementById('echarts-records'), 'walden');

        var optionRecords = {
            title: {
                text: '物理内存占用'
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    label: {
                        backgroundColor: '#6a7985'
                    }
                }
            },
            legend: {
                data: ['物理内存占用']
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            grid: {
                left: '1%',
                right: '1%',
                bottom: '40%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    boundaryGap: false,
                    data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日']
                }
            ],
            yAxis: [
                {
                    data: ["10%", "100%"],
                    min: 1,
                    max: 100,
                    type: 'value',
                }
            ],
            series: [
                {
                    name: '物理内存占用',
                    type: 'line',
                    stack: '百分比',
                    areaStyle: {},
                    data: [120, 132, 101, 134, 90, 230, 210]
                }
            ]
        };

        /**
         * 报表功能
         */
        var echartsRecords1 = echarts.init(document.getElementById('echarts-records1'), 'walden');

        var optionRecords1 = {
            title: {
                text: '交换内存占用'
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    label: {
                        backgroundColor: '#6a7985'
                    }
                }
            },
            legend: {
                data: ['交换内存占用']
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            grid: {
                left: '1%',
                right: '1%',
                bottom: '40%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    boundaryGap: false,
                    data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日']
                }
            ],
            yAxis: [
                {
                    data: ["10%", "100%"],
                    min: 1,
                    max: 100,
                    type: 'value',
                }
            ],
            series: [
                {
                    name: '交换内存占用',
                    type: 'line',
                    stack: '百分比',
                    areaStyle: {},
                    data: [120, 132, 101, 134, 90, 230, 210]
                }
            ]
        };

        axios({
            method: 'get',
            url: server_path + loadInfo + '160e259560cf49ad8577d91ee6cfaf01/memory',
            headers: {
                'Auth': getToken()
            }
        }).then((res) => {
            if (res.data.code === 0) {
                optionRecords.xAxis[0].data = res.data.data.xray;
                optionRecords.series = res.data.data.echartsData[0];
                optionRecords1.xAxis[0].data = res.data.data.xray;
                optionRecords1.series = res.data.data.echartsData[1];
                echartsRecords.setOption(optionRecords);
                echartsRecords1.setOption(optionRecords1)
                document.getElementById('memory').innerHTML = parseInt(res.data.data.echartsData[0].data[1]) + '%'
            }
        });

        window.localStorage.setItem("memoryall_chart_id", setInterval(async function () {
            axios({
                method: 'get',
                url: server_path + loadInfo + 'fe00ee78cdcb4417b77563bed9b8f13c/memory',
                headers: {
                    'Auth': getToken()
                }
            }).then((res) => {
                if (res.data.code === 0) {
                    optionRecords.xAxis[0].data = res.data.data.xray;
                    optionRecords1.xAxis[0].data = res.data.data.xray;
                    optionRecords1.series = res.data.data.echartsData[1];
                    echartsRecords.setOption(optionRecords);
                    echartsRecords1.setOption(optionRecords1)
                    document.getElementById('memory').innerHTML = parseInt(res.data.data.echartsData[0].data[1]) + '%'
                }
            });
        }, 3000))


        /**
         * 柱状图
         */
        var echartsDataset = echarts.init(document.getElementById('echarts-dataset'), 'walden');

        var optionDataset = {
            legend: {},
            tooltip: {},
            dataset: {
                dimensions: ['product', '2015', '2016', '2017'],
                source: [
                    {product: 'Matcha Latte', '2015': 43.3, '2016': 85.8, '2017': 93.7},
                    {product: 'Milk Tea', '2015': 83.1, '2016': 73.4, '2017': 55.1},
                    {product: 'Cheese Cocoa', '2015': 86.4, '2016': 65.2, '2017': 82.5},
                    {product: 'Walnut Brownie', '2015': 72.4, '2016': 53.9, '2017': 39.1}
                ]
            },
            xAxis: {type: 'category'},
            yAxis: {},
            // Declare several bar series, each will be mapped
            // to a column of dataset.source by default.
            series: [
                {type: 'bar'},
                {type: 'bar'},
                {type: 'bar'}
            ]
        };

        echartsDataset.setOption(optionDataset);

        /**
         * 中国地图
         */
        var echartsMap = echarts.init(document.getElementById('echarts-map'), 'walden');

        var optionMap = {
            legend: {},
            tooltip: {
                trigger: 'axis',
                showContent: false
            },
            dataset: {
                source: [
                    ['product', '2012', '2013', '2014', '2015', '2016', '2017'],
                    ['Matcha Latte', 41.1, 30.4, 65.1, 53.3, 83.8, 98.7],
                    ['Milk Tea', 86.5, 92.1, 85.7, 83.1, 73.4, 55.1],
                    ['Cheese Cocoa', 24.1, 67.2, 79.5, 86.4, 65.2, 82.5],
                    ['Walnut Brownie', 55.2, 67.1, 69.2, 72.4, 53.9, 39.1]
                ]
            },
            xAxis: {type: 'category'},
            yAxis: {gridIndex: 0},
            grid: {top: '55%'},
            series: [
                {type: 'line', smooth: true, seriesLayoutBy: 'row'},
                {type: 'line', smooth: true, seriesLayoutBy: 'row'},
                {type: 'line', smooth: true, seriesLayoutBy: 'row'},
                {type: 'line', smooth: true, seriesLayoutBy: 'row'},
                {
                    type: 'pie',
                    id: 'pie',
                    radius: '30%',
                    center: ['50%', '25%'],
                    label: {
                        formatter: '{b}: {@2012} ({d}%)'
                    },
                    encode: {
                        itemName: 'product',
                        value: '2012',
                        tooltip: '2012'
                    }
                }
            ]
        };

        echartsMap.setOption(optionMap);

        // echarts 窗口缩放自适应
        window.onresize = function () {
            echartsRecords.resize();
        }

    });
</script>
